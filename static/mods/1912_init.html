e=campaignTrail_temp

if (!e.runIntro) {
e.runIntro = true;

RecReading=true


nct_stuff.themes[nct_stuff.selectedTheme].coloring_window = "#73868A"
nct_stuff.themes[nct_stuff.selectedTheme].coloring_title = "#77211C"
$(".container")[0].style.backgroundColor = "#90999e"
$("#game_window")[0].style.borderColor = "#628775"
$("#game_window")[0].style.coloring_window = "#73868A"
$("#game_window")[0].style.backgroundColor = nct_stuff.themes[nct_stuff.selectedTheme].coloring_window;
document.body.background = "https://itsastronomical.com/assets/1912/NYCBG.png"
document.getElementById("header").src = "https://itsastronomical.com/assets/1912/1912_banner.png"
document.getElementById("wittyquote").color = "white"
nct_stuff.themes[nct_stuff.selectedTheme].text_col = "black"
campaignTrail_temp.credits = 'ItsAstronomical, with Horrificnecktieenjoyer, Josherskins, Flowersinthesnow and Mike McGovern helping';
styling = document.createElement("style");
document.head.appendChild(styling);          
styling.innerHTML = `
body {
    background-size: cover;
}
`


campaignTrail_temp.election_json = JSON.parse("[{\"model\": \"campaign_trail.election\", \"pk\": 4, \"fields\": {\"year\": 1912, \"summary\": \"<p>With the fever of Progressivism still in full swing, and a split in the Republican Party, Woodrow Wilson is the favorite to win the election heading into the fall campaign.</p><p>Wilson must keep his polling stable and make the case that he is a true progressive. President Taft must put together a coalition of conservatives to prevent a Wilson victory, or a deadlock, while Insurgent candidate Roosevelt must bring fire and fury to pull off a revenge against Taft.</p><p>The candidates all have to make the case to voters during all of this theatre. Wilson leads in the polls, but he and Roosevelt has a bit of a trust problem with labor.</p>\", \"image_url\": \"https://itsastronomical.com/assets/1912/1912.png\", \"winning_electoral_vote_number\": 266, \"advisor_url\": \"https://itsastronomical.com/assets/1912/1912.png\", \"recommended_reading\": \"<font color='#000000'><h4 style='margin-top: 0.5em;'>Message from the horrificnecktieenjoyer:</h4><p>Hello, thank you for playing my first mod! Of course I could not have done this without Astro. I hope you enjoyed this long awaited third party mod. This took a few months of work since I haven’t actually taken on a project like this before. Below are the sources I used for research; the greatest of which was Marxist Internet Archive, which has a ton of free resources for research. Many of the slide 2’s for endings are from socialist/Marxist writers and speakers, of which I got from MIA. Below are the main sources I used:</p><br><a href='https://www.marxists.org/' target='_blank'>marxists.org</a><br><br><a href='https://www.marxists.org/archive/debs/index.htm' target='_blank'>Eugene V. Debs Internet Archive</a><br><br>Eugene V. Debs: Socialist for President by Wayne Morgan</font>\", \"has_visits\": 0, \"no_electoral_majority_image\": \"/static/images/1968-no-majority.jpg\"}}]");
campaignTrail_temp.candidate_json = JSON.parse("[{\"model\": \"campaign_trail.candidate\", \"pk\": 24, \"fields\": {\"first_name\": \"Woodrow\", \"last_name\": \"Wilson\", \"election\": 4, \"party\": \"Democrat\", \"state\": \"New Jersey\", \"priority\": 2, \"description\": \"<p>Woodrow Wilson and the Democrats enter the 1912 campaign season in a cautiously optimistic position. With the rift in the Republican Party between the Regulars and Progressives growing stronger day by day, there is a high degree of confidence that Democrats can return to the White House for the first time in 16 years no matter what happens between Taft and Roosevelt.</p><p>Wilson's supporters will need to manuver during the Baltimore Convention to defeat frontrunner Champ Clark and secure the party's mantle - with the help of a variety of often conflicting forces. Then, Wilson will need to pivot to the general election, and dispatch the Republicans in whatever shape or form they take in order to return the Executive to the Democrats for the first time this century.</p>\", \"color_hex\": \"#5a5a90\", \"secondary_color_hex\": \"#90C0FF\", \"is_active\": 0, \"image_url\": \"https://itsastronomical.com/assets/1912/wilson.png\", \"electoral_victory_message\": \"<h3>Congratulations! You have won the 1968 election!</h3>\", \"electoral_loss_message\": \"<h3>Sorry, you have lost the 1968 election.</h3>\", \"no_electoral_majority_message\": \"<h3>Wow! No candidate achieved a majority in the electoral college.</h3>\", \"description_as_running_mate\": null, \"candidate_score\": 0.7}}, {\"model\": \"campaign_trail.candidate\", \"pk\": 23, \"fields\": {\"first_name\": \"William Howard\", \"last_name\": \"Taft\", \"election\": 4, \"party\": \"Republican (Regular)\", \"state\": \"Ohio\", \"priority\": 1, \"description\": \"<p>William Howard Taft enters the 1912 campagin season fighting a two front war. On the one side are the Democrats that seek to oust him from office. On the other side is a faction led by his old friend, Theodore Roosevelt. For the President, who did not even wish to run again, there is no room for error to prevent this assault on the very foundation of Government.</p><p>Taft, being the incumbemt, wields a variety of advantages (and disadvantages) that come with his position. His influence over party regulars should help keep the machinery working against Roosevelt. Facing Woodrow Wilson will be a challenge too, of course. Taft's general unpopularity with the public will make uniting a coalition to win much more difficult.</p>\", \"color_hex\": \"#a06e6e\", \"secondary_color_hex\": \"#FFA0A0\", \"is_active\": 0, \"image_url\": \"https://itsastronomical.com/assets/1912/taft.png\", \"electoral_victory_message\": \"<h3>Congratulations! You have won the 1924 election!</h3>\", \"electoral_loss_message\": \"<h3>Sorry, you have lost the 1924 election.</h3>\", \"description_as_running_mate\": null, \"candidate_score\": 0.666}}, {\"model\": \"campaign_trail.candidate\", \"pk\": 25, \"fields\": {\"first_name\": \"Theodore\", \"last_name\": \"Roosevelt\", \"election\": 4, \"party\": \"Republican (Progressive)\", \"state\": \"New York\", \"priority\": 3, \"description\": \"<p>Teddy Roosevelt enters the 1912 campaign looking to oust Taft and reclaim control of the Republican Party. He benefits from the unpopularity of the sitting President and a desire by many Progressives in the Republican Party to dump Taft and change course. Roosevelt's time away in Africa and Asia has only solidified his belief in a new nominee.</p><p>Roosevelt cannot just waltz in and be expected to be handed the nomination. Roosevelt must first triumph over party machinations and defeat Taft at the convention. Then, he must pivot towards the general election and prevent Democrats from reclaming the White House. Of course, he could also buck the two party system if all goes wrong...</p>\", \"color_hex\": \"#62a763\", \"secondary_color_hex\": \"#FFFFC0\", \"is_active\": 0, \"image_url\": \"https://itsastronomical.com/assets/1912/roosevelt.png\", \"electoral_victory_message\": \"<h3>Wow! You have won the 1968 election in a shocker!</h3>\", \"electoral_loss_message\": \"<h3>Sorry, you did not prevent an electoral college majority.</h3>\", \"no_electoral_majority_message\": \"<h3>Congratulations! You have deadlocked the electoral college with your votes in the South.</h3>\", \"description_as_running_mate\": null, \"candidate_score\": 1.0}}, {\"model\": \"campaign_trail.candidate\", \"pk\": 91, \"fields\": {\"first_name\": \"Eugene\", \"last_name\": \"Debs\", \"election\": 4, \"party\": \"Socialist\", \"state\": \"Indiana\", \"priority\": 1, \"description\": \"<p>Anyone paying attention sees this election for what it is: a disgraceful sham. With three major candidates running, none are willing to recognize the existential danger that Capitalism poses to the laborer. Eugene Debs, a candidate for the Socialist Party has had enough, and will throw his hat into the ring, hopefully to become the fourth major candidate</p><p>Debs' past campaigns have seen mixed success, consistently hovering around 2-3% of the vote. But with this much theatre and chaos, the time is ripe for the socialists, and the working man, to claim their seat at the political table. Debs will need to contend with both the chicanery the American state and his own Party can throw at him - as well as his own character flaws if he wants a chance in hell of uniting the party and sparking the class consciousness he's dedicated his life to spreading.</p>\", \"color_hex\": \"#680600\", \"secondary_color_hex\": \"#FFA0A0\", \"is_active\": 1, \"image_url\": \"https://itsastronomical.com/assets/1912/debs.png\", \"electoral_victory_message\": \"<h3>Congratulations! You have won the 1924 election!</h3>\", \"electoral_loss_message\": \"<h3>Sorry, you have lost the 1924 election.</h3>\", \"description_as_running_mate\": null, \"candidate_score\": 0.666}}, {\"model\": \"campaign_trail.candidate\", \"pk\": 95, \"fields\": {\"first_name\": \"Emil\", \"last_name\": \"Seidel\", \"election\": 4, \"party\": \"Socialist\", \"state\": \"Wisconsin\", \"priority\": 1, \"description\": \"<p>null</p>\", \"color_hex\": \"#a06e6e\", \"secondary_color_hex\": \"#FFA0A0\", \"is_active\": 0, \"image_url\": \"https://itsastronomical.com/assets/1912/emilseidel.png\", \"electoral_victory_message\": \"<h3>Congratulations! You have won the 1924 election!</h3>\", \"electoral_loss_message\": \"<h3>Sorry, you have lost the 1924 election.</h3>\", \"description_as_running_mate\": \"<p>The antidote to Debs’ radicalism is Mayor Emil Seidel. Pushed onto the ticket by the increasingly powerful Victor Berger, Seidel is representative of the right wing of the party. Born in Pennsylvania before moving to Wisconsin, Seidel was with the worker from the age of 13 onward as a woodcarver and became a member of the party in 1892.</p><p>Under his tenure as Mayor of Milwaukee, Seidel has achieved many reforms on the municipal level. The closing of brothels, regulation of gambling, and public works are just a few of his achievements in his remarkable achievement of being an elected socialist. His accomplishments will certainly draw some who are looking for genuine results to see as to what socialism could achieve in America.</p>\", \"candidate_score\": 0.666}}, {\"model\": \"campaign_trail.candidate\", \"pk\": 55, \"fields\": {\"first_name\": \"Spiro\", \"last_name\": \"Agnew\", \"election\": 4, \"party\": \"Republican\", \"state\": \"Maryland\", \"priority\": 29, \"description\": \"n/a\", \"color_hex\": \"#FF0000\", \"secondary_color_hex\": \"#FFA0A0\", \"is_active\": 0, \"image_url\": \"/static/images/spiro-agnew-1968.jpg\", \"electoral_victory_message\": \"n/a\", \"electoral_loss_message\": \"n/a\", \"no_electoral_majority_message\": \"n/a\", \"description_as_running_mate\": \"<p>Spiro Agnew has served as the Governor of Maryland since 1967, and he brings a reputation as a moderate on many issues including civil rights and the environment.</p><p>Agnew's Maryland background and his Greek heritage can help Nixon appeal both to Southern moderates and to blue collar workers who might otherwise be drawn to Wallace.</p>\", \"candidate_score\": 0.0}}, {\"model\": \"campaign_trail.candidate\", \"pk\": 56, \"fields\": {\"first_name\": \"Nelson\", \"last_name\": \"Rockefeller\", \"election\": 4, \"party\": \"Republican\", \"state\": \"New York\", \"priority\": 30, \"description\": \"n/a\", \"color_hex\": \"#FF0000\", \"secondary_color_hex\": \"#FFA0A0\", \"is_active\": 0, \"image_url\": \"/static/images/nelson-rockefeller-1968.jpg\", \"electoral_victory_message\": \"n/a\", \"electoral_loss_message\": \"n/a\", \"no_electoral_majority_message\": \"n/a\", \"description_as_running_mate\": \"<p>Rockefeller and Nixon competed vigorously for the 1968 nomination. Rockefeller's moderate reputation and New York location could both be assets in the campaign.</p><p>By selecting Rockefeller, Nixon would dampen his chances against Wallace in the South and would need to run well against Humphrey in the big northern cities to win the election.</p>\", \"candidate_score\": 0.0}}, {\"model\": \"campaign_trail.candidate\", \"pk\": 44, \"fields\": {\"first_name\": \"Ronald\", \"last_name\": \"Reagan\", \"election\": 4, \"party\": \"Republican\", \"state\": \"California\", \"priority\": 31, \"description\": \"n/a\", \"color_hex\": \"#FF0000\", \"secondary_color_hex\": \"#FFA0A0\", \"is_active\": 0, \"image_url\": \"/static/images/ronald-reagan-1968.jpg\", \"electoral_victory_message\": \"n/a\", \"electoral_loss_message\": \"n/a\", \"no_electoral_majority_message\": \"n/a\", \"description_as_running_mate\": \"<p>The standard-bearer of the conservative Republicans, Reagan can virtually assure a victory in California, where he presides as Governor. He has taken a firm stand against protests and disorder in that state and will reinforce Nixon's credibility as a champion of good order.</p><p>However, Reagan will not help Nixon very much in the competitive Northeast and Midwest states where he must challenge Humphrey.</p>\", \"candidate_score\": 0.0}}, {\"model\": \"campaign_trail.candidate\", \"pk\": 57, \"fields\": {\"first_name\": \"George\", \"last_name\": \"Romney\", \"election\": 4, \"party\": \"Republican\", \"state\": \"Michigan\", \"priority\": 32, \"description\": \"n/a\", \"color_hex\": \"#FF0000\", \"secondary_color_hex\": \"#FFA0A0\", \"is_active\": 0, \"image_url\": \"/static/images/george-romney-1968.jpg\", \"electoral_victory_message\": \"n/a\", \"electoral_loss_message\": \"n/a\", \"no_electoral_majority_message\": \"n/a\", \"description_as_running_mate\": \"<p>A moderate Republican from Michigan and another failed challenger to Nixon for the nomination, Romney can help immensely in the Midwest.</p><p>Romney is an avowed peace candidate however, which could hurt Nixon in the South. He will mainly help Nixon compete against Humphrey -- not against Wallace.</p>\", \"candidate_score\": 0.0}}, {\"model\": \"campaign_trail.candidate\", \"pk\": 58, \"fields\": {\"first_name\": \"Edmund\", \"last_name\": \"Muskie\", \"election\": 4, \"party\": \"Democrat\", \"state\": \"Maine\", \"priority\": 33, \"description\": \"n/a\", \"color_hex\": \"#0000FF\", \"secondary_color_hex\": \"#90C0FF\", \"is_active\": 0, \"image_url\": \"/static/images/edmund-muskie-1968.jpg\", \"electoral_victory_message\": \"n/a\", \"electoral_loss_message\": \"n/a\", \"no_electoral_majority_message\": \"n/a\", \"description_as_running_mate\": \"<p>Muskie is a Senator from Maine, and although he has a low national profile he could help Humphrey solidify his base and carry the Northeastern states.</p><p>By going with Muskie, Humphrey would probably be writing off most of the South and also would be giving Nixon an opening among moderate voters.</p>\", \"candidate_score\": 0.0}}, {\"model\": \"campaign_trail.candidate\", \"pk\": 59, \"fields\": {\"first_name\": \"Fred\", \"last_name\": \"Harris\", \"election\": 4, \"party\": \"Democrat\", \"state\": \"Oklahoma\", \"priority\": 34, \"description\": \"n/a\", \"color_hex\": \"#0000FF\", \"secondary_color_hex\": \"#90C0FF\", \"is_active\": 0, \"image_url\": \"/static/images/fred-harris-1968.jpg\", \"electoral_victory_message\": \"n/a\", \"electoral_loss_message\": \"n/a\", \"no_electoral_majority_message\": \"n/a\", \"description_as_running_mate\": \"<p>A Democrat from Oklahoma, Harris could help his party make a play for some of the Southern states without alienating its liberal wing.</p><p>Harris will add very little to the campaign if he fails to deliver some states in the South, and his young age (37 years) could be alarming to some voters.</p>\", \"candidate_score\": 0.0}}, {\"model\": \"campaign_trail.candidate\", \"pk\": 60, \"fields\": {\"first_name\": \"John\", \"last_name\": \"Connally\", \"election\": 4, \"party\": \"Democrat\", \"state\": \"Texas\", \"priority\": 35, \"description\": \"n/a\", \"color_hex\": \"#0000FF\", \"secondary_color_hex\": \"#90C0FF\", \"is_active\": 0, \"image_url\": \"/static/images/john-connally-1968.jpg\", \"electoral_victory_message\": \"n/a\", \"electoral_loss_message\": \"n/a\", \"no_electoral_majority_message\": \"n/a\", \"description_as_running_mate\": \"<p>Connally was and is the Governor of Texas who was infamously wounded in the Kennedy Assassination. He would reinforce a moderate image, help deliver Texas to the ticket, and dampen the appeal of Wallace elsewhere to all but the most hard-line segregationists.</p><p>However the anti-war, liberal wing of the party will surely recoil at this selection.</p>\", \"candidate_score\": 0.0}}, {\"model\": \"campaign_trail.candidate\", \"pk\": 61, \"fields\": {\"first_name\": \"Ted\", \"last_name\": \"Kennedy\", \"election\": 4, \"party\": \"Democrat\", \"state\": \"Massachusetts\", \"priority\": 36, \"description\": \"n/a\", \"color_hex\": \"#0000FF\", \"secondary_color_hex\": \"#90C0FF\", \"is_active\": 0, \"image_url\": \"/static/images/ted-kennedy-1968.jpg\", \"electoral_victory_message\": \"n/a\", \"electoral_loss_message\": \"n/a\", \"no_electoral_majority_message\": \"n/a\", \"description_as_running_mate\": \"<p>Younger brother to John and Robert Kennedy and a staunch liberal, Ted Kennedy would be a choice if Humphrey wished to reconcile with the liberal and anti-war wing of the party.</p><p>Kennedy will not accept the nomination, however, unless Humphrey repudiates the hawkish policies of President Johnson. This could cause problems with moderates and more importantly with the Democratic establishment.</p>\", \"candidate_score\": 0.0}}, {\"model\": \"campaign_trail.candidate\", \"pk\": 62, \"fields\": {\"first_name\": \"Curtis\", \"last_name\": \"LeMay\", \"election\": 4, \"party\": \"Republican\", \"state\": \"Ohio\", \"priority\": 37, \"description\": \"n/a\", \"color_hex\": \"#FF0000\", \"secondary_color_hex\": \"#FFA0A0\", \"is_active\": 0, \"image_url\": \"/static/images/curtis-lemay-1968.jpg\", \"electoral_victory_message\": \"n/a\", \"electoral_loss_message\": \"n/a\", \"no_electoral_majority_message\": \"n/a\", \"description_as_running_mate\": \"<p>A famous (some say infamous) General in the Army for many years, LeMay is dismayed by the prospect of Richard Nixon accepting nuclear parity with the Soviet Union. He also is drawn to Wallace's message of social order.</p><p>LeMay is prone to make off the cuff remarks about the use of nuclear weapons, however, which could lead to concerns about Wallace's foreign policy vision.</p>\", \"candidate_score\": 0.0}}, {\"model\": \"campaign_trail.candidate\", \"pk\": 63, \"fields\": {\"first_name\": \"Happy\", \"last_name\": \"Chandler\", \"election\": 4, \"party\": \"Democrat\", \"state\": \"Kentucky\", \"priority\": 38, \"description\": \"n/a\", \"color_hex\": \"#0000FF\", \"secondary_color_hex\": \"#90C0FF\", \"is_active\": 0, \"image_url\": \"/static/images/happy-chandler-1968.jpg\", \"electoral_victory_message\": \"n/a\", \"electoral_loss_message\": \"n/a\", \"no_electoral_majority_message\": \"n/a\", \"description_as_running_mate\": \"<p>A Democratic Senator from Kentucky and former Commissioner of Major League Baseball, Chandler would give Wallace's outsider campaign some credibility.</p><p>As a conservative Democrat, Chandler supports the calls for law and order and fiscal conservatism. However, he will not stand as Wallace's running mate unless he softens his rhetoric on segregation, which in turn could alienate other Southern states.</p>\", \"candidate_score\": 0.0}}, {\"model\": \"campaign_trail.candidate\", \"pk\": 64, \"fields\": {\"first_name\": \"Strom\", \"last_name\": \"Thurmond\", \"election\": 4, \"party\": \"Republican\", \"state\": \"South Carolina\", \"priority\": 39, \"description\": \"n/a\", \"color_hex\": \"#FF0000\", \"secondary_color_hex\": \"#FFA0A0\", \"is_active\": 0, \"image_url\": \"/static/images/strom-thurmond-1968.jpg\", \"electoral_victory_message\": \"n/a\", \"electoral_loss_message\": \"n/a\", \"no_electoral_majority_message\": \"n/a\", \"description_as_running_mate\": \"<p>The most mainline Southerner among Wallace's options, Thurmond did well in his own right when running in 1948.</p><p>Thurmond's presence could help tilt the Carolinas in Wallace's direction, but it will take every ounce of Wallace's persuasive acumen to get Thurmond to agree to run.</p>\", \"candidate_score\": 0.0}}]");

campaignTrail_temp.running_mate_json = JSON.parse("[{\"model\": \"campaign_trail.running_mate\", \"pk\": 1, \"fields\": {\"candidate\": 91, \"running_mate\": 95}}, {\"model\": \"campaign_trail.running_mate\", \"pk\": 2, \"fields\": {\"candidate\": 24, \"running_mate\": 58}},  {\"model\": \"campaign_trail.running_mate\", \"pk\": 3, \"fields\": {\"candidate\": 23, \"running_mate\": 55}}, {\"model\": \"campaign_trail.running_mate\", \"pk\": 4, \"fields\": {\"candidate\": 25, \"running_mate\": 62}}]");

campaignTrail_temp.opponents_default_json = JSON.parse("[{\"election\": 4, \"candidates\": [25, 24, 23, 91]}]");

campaignTrail_temp.global_parameter_json = JSON.parse("[{\"model\": \"campaign_trail.global_parameter\", \"pk\": 1, \"fields\": {\"vote_variable\": 1.125, \"max_swing\": 0.12, \"start_point\": 0.94, \"candidate_issue_weight\": 10.0, \"running_mate_issue_weight\": 3.0, \"issue_stance_1_max\": -0.71, \"issue_stance_2_max\": -0.3, \"issue_stance_3_max\": -0.125, \"issue_stance_4_max\": 0.125, \"issue_stance_5_max\": 0.3, \"issue_stance_6_max\": 0.71, \"global_variance\": 0.01, \"state_variance\": 0.005, \"question_count\": 25, \"default_map_color_hex\": \"#C9C9C9\", \"no_state_map_color_hex\": \"#999999\"}}]");

campaignTrail_temp.temp_election_list = [{"id": 4, "year": 1912, "is_premium": 0, "display_year": "1912"}];

$("#game_start").click((event) => {
    event.preventDefault();
    $("#election_id_button").click((event) => {
        event.preventDefault();
        nct_stuff.themes[nct_stuff.selectedTheme].coloring_title = "#77211c";
        nct_stuff.themes[nct_stuff.selectedTheme].coloring_window = "#ddad9d";
        $("#game_window")[0].style.backgroundColor = nct_stuff.themes[nct_stuff.selectedTheme].coloring_window;
        document.getElementsByClassName("game_header")[0].style.backgroundColor = nct_stuff.themes[nct_stuff.selectedTheme].coloring_title;
        $(".container")[0].style.backgroundColor = "#aa3816";
        document.head.innerHTML += "<style>#results_container {color:#000000;} .inner_window_w_desc {background-color:#ddad9d!important;}</style>";
        corrr = `\n<h2>UNITE AT THE BALLOT BOX</h2>`
        document.body.background = "https://itsastronomical.com/assets/1912/workers.png"
        document.getElementById("header").src = "https://itsastronomical.com/assets/1912/worker_banner.png"
        nct_stuff.themes[nct_stuff.selectedTheme].text_col = "white"
        musicMode()
        e.election_json[0].fields.summary = "<p>It is this capitalist system that is responsible for the increasing burden of armaments, the poverty, slums, child labor, most of the insanity, crime and prostitution, and much of the disease that afflicts mankind.</p><p>Here lies three candidates running for the office of President. They will clamor for the socialist vote, but none of them are willing to do what has to be done to save the working class.</p>"
        e.election_json[0].fields.image_url = "https://itsastronomical.com/assets/1912/1912_alt.png"
        setInterval(changeFontColour, 200)
  
    })
  })


musicMode = () => {
  //30's Player

// Initialise custom music

RecReading = true;

// Select the node that will be observed for mutations
const windowsAdvisorTargetNode = document.getElementById("game_window");

// Options for the observer (which mutations to observe)
const windowsAdvisorConfig = { attributes: true, childList: true, subtree: true };

// Callback function to execute when mutations are observed
const callback = (mutationList, observer) => {
    visitWindow = document.getElementsByClassName("overlay_window")[0];

    if (visitWindow == null || visitWindow.classList.contains("done")) {
        return;
    }
    visitWindow.classList.add("done");
    visitWindow.classList.add("window");
    let titleBar = visitWindow.querySelector("h3");
    titleBar.classList.add("title-bar");
    titleBar.classList.add("title-bar-text");
    titleBar.style.paddingLeft = "3px";
};

class Song {
    constructor(title, artist, coverLink, audioLink) {
        this.title = title;
        this.artist = artist;
        this.coverLink = coverLink;
        this.audioLink = audioLink;
    }
    getTitle() {
        return this.title;
    }

    getArtist() {
        return this.artist;
    }

    getCoverLink() {
        return this.coverLink;
    }

    getAudioLink() {
        return this.audioLink;
    }
}

class Playlist {
    constructor() {
        this.songs = [];
        this.currentSongIndex = 0;
    }

    addSong(song) {
        this.songs.push(song);
    }

    getCurrentSong() {
        return this.songs[this.currentSongIndex];
    }

    playNext() {
        this.currentSongIndex = (this.currentSongIndex + 1) % this.songs.length;
    }

    playPrevious() {
        this.currentSongIndex = (this.currentSongIndex - 1 + this.songs.length) % this.songs.length;
    }
}
window.Playlist = Playlist;
window.Song = Song;

function changePlaylist(newPlaylist) {
    playlist = newPlaylist;
    playlist.currentSongIndex = 0;
    updateUI(playlist);
    const audio = document.getElementById("audio");
    audio.src = playlist.getCurrentSong().audioLink;
    audio.play();
}
window.changePlaylist = changePlaylist;

function updateUI(playlist) {
    const currentSong = playlist.getCurrentSong();
    var player = document.getElementById("player");
    player.querySelector("#cover").src = currentSong.getCoverLink();
    player.querySelector("#title").textContent = currentSong.getTitle();
    player.querySelector("#artist").textContent = currentSong.getArtist();
}

window.updateUI = updateUI;

function setupMusicPlayer() {
    playlist = new Playlist();

    const song1 = new Song(
        "Fanfare for the Common Man",
        "Aaron Copland",
        "https://itsastronomical.com/assets/1912/fanfare.png",
        "https://audio.jukehost.co.uk/DUNx5Q0Omn8NiBcHdc7rLbQcWl0BmGdD"
    );
        const song2 = new Song(
        "L'Internationale",
        "Unknown, French Recording",
        "https://itsastronomical.com/assets/1912/inter.png",
        "https://audio.jukehost.co.uk/Dsy0PwTj4578XeP3aj2ZiR1CeCnbrH5P"
    );
        const song3 = new Song(
        "La Marseillaise de la Commune",
        "Unknown, French Recording",
        "https://i1.sndcdn.com/artworks-000395256144-p9uvmk-t500x500.jpg",
        "https://audio.jukehost.co.uk/ofQw2UnrPp7Y69Ed2QiqyWa1ahMGJKzT"
    );
        const song4 = new Song(
        "Solidarity Forever",
        "Pete Seeger",
        "https://itsastronomical.com/assets/1912/solid.png",
        "https://audio.jukehost.co.uk/NHuH9h3RnaComkQV3b0ztp2TkcTiedpv"
    );
        const song5 = new Song(
        "Which Side Are You On?",
        "Pete Seeger",
        "https://itsastronomical.com/assets/1912/side.png",
        "https://audio.jukehost.co.uk/2caVlMF2UvVFiMybYPKDoqMG6rAuzPlz"
    );

    playlist.addSong(song1);
    playlist.addSong(song2);
    playlist.addSong(song3);
    playlist.addSong(song4);
    playlist.addSong(song5);


    const playerContainer = document.createElement("div");
    playerContainer.id = "player";

    const displayBox = document.createElement("div");
    displayBox.id = "display-box";

    const coverElement = document.createElement("img");
    coverElement.id = "cover";
    displayBox.appendChild(coverElement);

    const infoContainer = document.createElement("div");
    infoContainer.id = "info-container";
    infoContainer.style.backgroundImage = "url('https://i.imgur.com/HTUJApX.png')";
    infoContainer.style.backgroundSize = "cover";
    infoContainer.style.color = "#6e441b";

    const songInfo = document.createElement("div");
    songInfo.id = "song-info";

    const titleElement = document.createElement("h3");
    titleElement.id = "title";
    titleElement.style.fontWeight = 'normal';
    songInfo.appendChild(titleElement);

    const artistElement = document.createElement("p");
    artistElement.id = "artist";
    songInfo.appendChild(artistElement);

    infoContainer.appendChild(songInfo);
    displayBox.appendChild(infoContainer);

    playerContainer.appendChild(displayBox);

    const controlsContainer = document.createElement("div");
    controlsContainer.id = "controls-container";

    const controls = document.createElement("div");
    controls.id = "controls";

    const volumeDownButton = document.createElement("img");
    volumeDownButton.id = "volumeDownButton";
    volumeDownButton.src = "https://i.imgur.com/VQfvYev.png";
    volumeDownButton.alt = "Volume Down";
    controls.appendChild(volumeDownButton);

    const prevButton = document.createElement("img");
    prevButton.id = "prevButton";
    prevButton.src = "https://i.imgur.com/LAojana.png";
    prevButton.alt = "Previous";
    controls.appendChild(prevButton);

    const playPauseButton = document.createElement("img");
    playPauseButton.id = "playPauseButton";
    playPauseButton.src = "https://i.imgur.com/JdndnqR.png";
    playPauseButton.alt = "Play/Pause";
    controls.appendChild(playPauseButton);

    const nextButton = document.createElement("img");
    nextButton.id = "nextButton";
    nextButton.src = "https://i.imgur.com/VpjQN97.png";
    nextButton.alt = "Next";
    controls.appendChild(nextButton);

    const volumeUpButton = document.createElement("img");
    volumeUpButton.id = "volumeUpButton";
    volumeUpButton.src = "https://i.imgur.com/AWjSTLv.png";
    volumeUpButton.alt = "Volume Up";
    controls.appendChild(volumeUpButton);

    controlsContainer.appendChild(controls);

    playPauseButton.addEventListener("click", function () {
        const audio = document.getElementById("audio");
        if (audio.paused) {
            audio.play();
            playPauseButton.src = "https://i.imgur.com/JdndnqR.png";
        } else {
            audio.pause();
            playPauseButton.src = "https://i.imgur.com/nzG7asd.png";
        }
    });

    nextButton.addEventListener("click", function () {
        playlist.playNext();
        updateUI(playlist);
        const audio = document.getElementById("audio");
        audio.src = playlist.getCurrentSong().audioLink;
        audio.play();
        rotateButton(nextButton, "right");
    });

    prevButton.addEventListener("click", function () {
        playlist.playPrevious();
        updateUI(playlist);
        const audio = document.getElementById("audio");
        audio.src = playlist.getCurrentSong().audioLink;
        audio.play();
        rotateButton(prevButton, "left");
    });

    let currentVolume = 6; // Medium initial volume 

    volumeUpButton.addEventListener("click", function () {
        const audio = document.getElementById("audio");
        if (currentVolume < 20) { // Increased max volume range
            currentVolume++;
            audio.volume = currentVolume / 20; // Adjusted for new range
            rotateButton(volumeUpButton, "left");
        }
    });
    
    volumeDownButton.addEventListener("click", function () {
        const audio = document.getElementById("audio");
        if (currentVolume > 0) {
            currentVolume--;
            audio.volume = currentVolume / 20; // Adjusted for new range
            rotateButton(volumeDownButton, "right");
        }
    });

    function rotateButton(button, direction) {
        const rotationAngle = direction === "left" ? "rotate(-15deg)" : "rotate(15deg)";
        button.style.transform = rotationAngle;
        setTimeout(() => {
            button.style.transform = "rotate(0deg)";
        }, 200);
    }

    const progressBarContainer = document.createElement("div");
    progressBarContainer.id = "progress-bar-container";

    const progressBar = document.createElement("progress");
    progressBar.type = "range";
    progressBar.id = "progress-bar";
    progressBar.value = "0";
    progressBar.max = "100";

    progressBarContainer.appendChild(progressBar);
    controlsContainer.appendChild(progressBarContainer);
    playerContainer.appendChild(controlsContainer);

    const lipImage = document.createElement("div");
    lipImage.id = "lip-overlay";
    playerContainer.appendChild(lipImage); // Add the overlay as a child of #player
    
    

    gameWindow_player.insertAdjacentElement("afterend", playerContainer);

    function updateProgressBar() {
        const audio = document.getElementById("audio");
        const progress = (audio.currentTime / audio.duration) * 100;
        try {
            progressBar.value = progress;
        } catch {}
    }

    progressBar.addEventListener("input", function () {
        const audio = document.getElementById("audio");
        const seekTime = (progressBar.value / 100) * audio.duration;
        audio.currentTime = seekTime;
    });

    const audio = document.createElement("audio");
    audio.id = "audio";
    audio.src = playlist.getCurrentSong().audioLink;

    audio.addEventListener("timeupdate", updateProgressBar);
    audio.addEventListener("ended", function () {
        playlist.playNext();
        updateUI(playlist);
        audio.src = playlist.getCurrentSong().audioLink;
        audio.play();
    });

    document.body.appendChild(audio);
    audio.play();

    updateUI(playlist);
}

const style = document.createElement("style");
style.textContent = `
#player {
    position: relative; /* Ensures child absolute elements are positioned relative to this */
    border: 3px solid #5e2f0d;
    display: flex;
    flex-direction: row;
    height: 191px;
    background-image: url("https://i.imgur.com/XvHX0fc.png");
    transition: transform 0.2s ease;
}

#lip-overlay {
    position: absolute;
    top: 0; /* Align at the top of the player */
    left: 0;
    width: 100%;
    height: 100%; /* Same height as the #player */
    z-index: 2; /* Brings it to the foreground */
    pointer-events: none; /* Prevent interference with user interactions */
    background-image: url('https://i.imgur.com/4vt4JNH.png');
    background-size: cover; /* Ensures the image fills the container */
}


#display-box {
    display: flex;
    align-items: center;
    width: 50%;
}

#cover {
    width: 176px;
    height: 176px;
}

#info-container {
    display: flex;
    flex-direction: row;
    height: 178px;
    width: 127px;
    margin-top: 3px;
    margin-left: 5px;
}

#song-info {
    width: 100%;
    padding: 5px;
}

#controls-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin: 10px;
    width: 100%;
    padding-top: 15px;
}

#controls {
    display: flex;
    flex-direction: row;
    justify-content: center;
    width: 80%;
}

#progress-bar-container {
    width: 100%;
}

#progress-bar {
    width: 80%;
    margin: auto;
    display: flex;
    margin-top: 20px;
    height: 8px;
    background-color: rgba(0, 0, 0, 0.5);
    border-radius: 5px;
    overflow: hidden;
}

#progress-bar::-webkit-progress-bar {
    background-color: rgba(0, 0, 0, 0.5);
}

#progress-bar::-webkit-progress-value {
    background-color: rgba(255, 255, 255, 0.5);
}

#progress-bar::-moz-progress-bar {
    background-color: rgba(255, 255, 255, 0.5);
}



`;

document.head.appendChild(style);

const gameWindow_player = document.getElementById("game_window");
setupMusicPlayer();
}

}

// ctsAchievement("")
campaignTrail_temp.achievements = {
    "Princeton to the Presidency" : { 
        "image" : "https://itsastronomical.com/assets/1912/achieve/wilson.png",
        "description" : "Win as Wilson with over 500 Electoral Votes",
        "cannotBeCheated" : true
     },
     "The People's Choice" : { 
        "image" : "https://itsastronomical.com/assets/1912/achieve/donkey.png",
        "description" : "As Wilson, sweep the convention",
        "cannotBeCheated" : true
     },
     "Filling the Shoes" : { 
        "image" : "https://itsastronomical.com/assets/1912/achieve/shoes.png",
        "description" : "As Wilson, let Clark have his day",
        "cannotBeCheated" : true
     },
     "Of Course I Added This" : { 
        "image" : "https://itsastronomical.com/assets/1912/achieve/hoosier.png",
        "description" : "As Wilson, do the thing that's already been done before",
        "cannotBeCheated" : true
     },
     "Blissfulness" : { 
        "image" : "https://itsastronomical.com/assets/1912/achieve/bliss.png",
        "description" : "As Wilson, don't attack your primary opposition and still win the nomination.",
        "cannotBeCheated" : true
     },
     "Woodrow Woke-sin" : { 
        "image" : "https://itsastronomical.com/assets/1912/achieve/woke.png",
        "description" : "As Wilson, go woke and support Women's Suffrage ahead of time",
        "cannotBeCheated" : true
     },
     "I Keep My Bridges Next To Me" : { 
        "image" : "https://itsastronomical.com/assets/1912/achieve/speaker.png",
        "description" : "As Wilson, have Clark resign as Speaker of the House",
        "cannotBeCheated" : true
     },
     "Canon Event" : { 
        "image" : "https://itsastronomical.com/assets/1912/achieve/canon.png",
        "description" : "As Wilson, get the exact history Electoral Vote tally.",
        "cannotBeCheated" : true
     },
     "Toryism" : { 
        "image" : "https://itsastronomical.com/assets/1912/achieve/tory.png",
        "description" : "As Wilson, push Taft into changing course. May require Hard difficulty, or higher.",
        "cannotBeCheated" : true
     },
     "Honest John" : { 
        "image" : "https://itsastronomical.com/assets/1912/achieve/president.png",
        "description" : "As Wilson, help bring about a new President",
        "cannotBeCheated" : true
     },
     "Wake Up America!" : { 
        "image" : "https://itsastronomical.com/assets/1912/achieve/greatwar.png",
        "description" : "As Wilson, join World War I ahead of time",
        "cannotBeCheated" : true
     },
     "The Darkest Timeline" : { 
        "image" : "https://itsastronomical.com/assets/1912/achieve/flag.png",
        "description" : "As Wilson, deadlock or lose the election",
        "cannotBeCheated" : true
     },
     "The Internationale" : { 
        "image" : "https://itsastronomical.com/assets/1912/achieve/tall.png",
        "description" : "As Debs, destroy an artifact of bourgeois politics. Easy difficulty and lower allowed.",
        "cannotBeCheated" : false
     },
     "I was, I am, I shall be!" : { 
        "image" : "https://itsastronomical.com/assets/1912/achieve/yell.png",
        "description" : "As Debs, outrun history and perform better than the historical results.",
        "cannotBeCheated" : true
     },
     "The Red Flag" : { 
        "image" : "https://itsastronomical.com/assets/1912/achieve/king.png",
        "description" : "As Debs, enter the Electoral College.",
        "cannotBeCheated" : true
     },
     "Gompers' Heroes" : { 
        "image" : "https://itsastronomical.com/assets/1912/achieve/gomp.png",
        "description" : "As Debs, pour one out for social democracy.",
        "cannotBeCheated" : true
     },
     "Einheitsfront" : { 
        "image" : "https://itsastronomical.com/assets/1912/achieve/inter.png",
        "description" : "As Debs, redirect the Progressive movement.",
        "cannotBeCheated" : true
     },
     "Hoosier Loser" : { 
        "image" : "https://itsastronomical.com/assets/1912/achieve/ruling.png",
        "description" : "As Debs, do a good job for the ruling class.",
        "cannotBeCheated" : true
     },
}

campaignTrail_temp.modBoxTheme = {
    "header_color": "#77211c",
    "header_text_color": "#ffffff",
    "description_text_color": "#ffffff",
    "description_background_color": "#727c96",
    "main_color": "#727c96",
    "secondary_color": "#77211c",
    "ui_text_color": "#FFFFFF"
}

HistHexcolour=["#5a5a90","#62a763","#a06e6e","#680600"];
        HistName=[" CAPITAL"," CAPITAL"," CAPITAL"," The Workers/Others"];
        HistEV=[435,88,8,0];
        HistPV=["6,296,284","4,122,721","3,486,242","1,143,587"];
        HistPVP=["41.84%","27.40%","23.17%","7.59%"];